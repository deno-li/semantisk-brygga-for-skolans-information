{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Semantic Bridge Exchange",
  "description": "Dataflöden mellan React-gränssnittet och FastAPI-backenden",
  "type": "object",
  "properties": {
    "mappingRequest": {
      "type": "object",
      "required": ["source_system", "target_system", "code"],
      "properties": {
        "source_system": { "type": "string", "enum": ["icf", "ksi", "bbic"] },
        "target_system": { "type": "string", "enum": ["icf", "ksi", "bbic"] },
        "code": { "type": "string" }
      }
    },
    "mappingResponse": {
      "type": "object",
      "required": ["source_code", "target_system", "target_codes", "confidence"],
      "properties": {
        "source_code": { "type": "string" },
        "source_system": { "type": "string" },
        "target_system": { "type": "string" },
        "target_codes": { "type": "array", "items": { "type": "string" } },
        "target_descriptions": { "type": "array", "items": { "type": "string" } },
        "confidence": { "type": "number", "minimum": 0, "maximum": 1 },
        "metadata": { "type": "object" },
        "warnings": { "type": "array", "items": { "type": "string" } }
      }
    },
    "aiAnalysisRequest": {
      "type": "object",
      "required": ["text"],
      "properties": {
        "text": { "type": "string" },
        "context": { "type": "string" },
        "standards": { "type": "array", "items": { "type": "string" } }
      }
    },
    "aiAnalysisResponse": {
      "type": "object",
      "required": ["text", "icf_suggestions", "analysis_summary", "confidence"],
      "properties": {
        "text": { "type": "string" },
        "icf_suggestions": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["code", "description", "confidence"],
            "properties": {
              "code": { "type": "string" },
              "description": { "type": "string" },
              "confidence": { "type": "number", "minimum": 0, "maximum": 1 },
              "category": { "type": "string" },
              "reasoning": { "type": "string" }
            }
          }
        },
        "bbic_domains": {
          "type": "array",
          "items": { "type": "array", "items": { "type": "string" } }
        },
        "analysis_summary": { "type": "string" },
        "confidence": { "type": "number", "minimum": 0, "maximum": 1 }
      }
    }
  }
}
