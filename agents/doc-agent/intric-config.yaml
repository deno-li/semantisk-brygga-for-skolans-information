# Intric Agent Configuration
# Dokumentationsagent för Semantisk Brygga
#
# Använd denna fil som referens för att konfigurera agenten i Intric.
# Kopiera relevanta värden till Intric's webbgränssnitt.

agent:
  name: "Dokumentationsagent - Semantisk Brygga"
  description: |
    Specialiserad agent för kodning och dokumentation inom
    skolans, socialtjänstens och hälso- och sjukvårdens
    klassifikationssystem (ICF, KSI, BBIC, KVÅ).

  # Modellkonfiguration
  model:
    provider: "anthropic"
    name: "claude-sonnet-4-5-20250514"
    parameters:
      temperature: 0.3          # Låg för konsekvent kodning
      max_tokens: 8192          # Tillräckligt för detaljerade svar
      top_p: 0.95               # Hög precision

  # Systemprompt (ladda från system-prompt.md)
  system_prompt_file: "system-prompt.md"

# Kunskapskällor för RAG
knowledge_base:
  enabled: true
  chunk_size: 1000
  chunk_overlap: 200
  embedding_model: "text-embedding-3-small"

  sources:
    - name: "WHO ICF"
      type: "tsv"
      path: "data/icf.tsv"
      description: "International Classification of Functioning"
      priority: 1

    - name: "KSI"
      type: "tsv"
      path: "data/ksi.tsv"
      description: "Klassifikation av Socialtjänstens Insatser"
      priority: 1

    - name: "KVÅ"
      type: "tsv"
      path: "data/kva-medicinska-atgarder-kma.tsv"
      description: "Klassifikation av Vårdåtgärder"
      priority: 2

    - name: "ICF Core Sets"
      type: "xlsx"
      path: "data/icf-2025-inkl-core-sets.xlsx"
      description: "ICF core sets per område"
      priority: 2

    - name: "Barnets Resa Matris"
      type: "xlsx"
      path: "data/Barnets_resa_matris.xlsx"
      description: "3-nivåmodellen specifikation"
      priority: 1

# Retrieval-inställningar
retrieval:
  top_k: 10                     # Antal dokument att hämta
  similarity_threshold: 0.7     # Minsta likhetströskel
  rerank: true                  # Använd reranking
  hybrid_search: true           # Kombinera semantisk + keyword-sökning

# Konversationsminne
memory:
  enabled: true
  max_history: 20               # Antal tidigare meddelanden
  summarize_after: 15           # Sammanfatta efter N meddelanden

# Verktyg/funktioner (om tillgängliga i Intric)
tools:
  - name: "search_icf"
    description: "Sök i ICF-klassifikationen"
    enabled: true

  - name: "search_ksi"
    description: "Sök i KSI-klassifikationen"
    enabled: true

  - name: "map_codes"
    description: "Mappa mellan klassifikationssystem"
    enabled: true

# Svarsformat
response:
  language: "sv"
  include_sources: true
  include_confidence: true
  structured_output: true

  format_template: |
    ## Kodförslag
    {codes}

    ## SHANARRI-mappning
    {shanarri_mapping}

    ## Rekommenderad nivå
    {level_recommendation}

    ## Källa
    {sources}

# Guardrails
safety:
  # Förhindra output av riktiga personuppgifter
  pii_filter: true

  # Påminn om att detta är prototyp
  disclaimer: |
    OBS: Detta är en prototyp för test och utveckling.
    Ersätter inte professionell bedömning.

  # Blockerade ämnen
  blocked_topics:
    - "personuppgifter"
    - "personnummer"
    - "patientjournaler"

# Testscenarier för validering
test_cases:
  - name: "Grundläggande ICF-kodning"
    input: "Barnet har svårt att fokusera under lektionerna."
    expected_codes: ["ICF:b140", "ICF:d160"]

  - name: "SHANARRI-bedömning"
    input: "Eleven undviker sociala situationer och saknar vänner."
    expected_shanarri: ["Included: gul/röd"]

  - name: "Nivåbedömning"
    input: "Samverkan mellan skola, BUP och socialtjänst behövs."
    expected_level: "N3"
